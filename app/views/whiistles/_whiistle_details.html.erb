<% hide_parent_whiistles_of_replies = local_assigns.fetch(:hide_parent_whiistles_of_replies, false) %>

<% if !hide_parent_whiistles_of_replies && (whiistle.is_a?(Reply) || whiistle.is_a?(Flood) ) %>
  <%= render "whiistles/whiistle", whiistle: whiistle.whiistle %>
<% end %>

<div class="my-4">

  <%= render "whiistles/rewhiistle_info", whiistle: whiistle %>

  <div class='flex  <%= check_click(whiistle) %> '>
    
    <%= link_to user_whiistles_path(whiistle.user), class: "hover-image shrink-0" do %>
      <div>
        <%= image_tag( show_profile_picture(whiistle.user.profile_picture), size: '50x50') %>
      </div>
    <% end %>
    
    <div class="pl-2">
      <%= link_to user_whiistles_path(whiistle.user) do %>
        <span class="text-dark">
          <%= whiistle.user.fullname %>
        </span>
        @<%= whiistle.user.username %>
      <% end %>
      
      <%= link_to whiistle_path(whiistle) do %>
        - <%= distance_of_time_in_words(Time.now, whiistle.created_at, compact: true, highest_measure_only: true) %>    
      <% end %>

      <div>
        <%= yield dom_id(whiistle, :reply_info) %>
      </div>
      
      <div class="mt-2">
        <%= link_to whiistle_path(whiistle) do %>
          <%= whiistle.body  %>
        <% end %>
        
        <%= render "whiistles/pictures", whiistle: whiistle %>
      </div>
      
      <% if whiistle.is_a? QuotedWhiistle %>
        <%= render "whiistles/quoted_whiistle", whiistle: whiistle.whiistle %>
      <% end %>
      
      <div class="flex"> 
        <%= render "whiistles/reply_button", whiistle: whiistle %>
        <%= render "whiistles/toggle_rewhiistle_or_quote_button", whiistle: whiistle %>
        <%= render "whiistles/like_button", whiistle: whiistle %>
      </div>

      <turbo-frame id=<%= whiistle_reply_form_target(whiistle) %> >
      </turbo-frame>
      <turbo-frame id=<%= whiistle_quoted_whiistle_form_target(whiistle) %> >
      </turbo-frame>

    </div>
  </div>
</div>